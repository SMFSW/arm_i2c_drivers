/*!\file $CPNT$_proc.c
** \author SMFSW
** \copyright MIT (c) 2017-2026, SMFSW
** \brief $CPNT$ Driver procedures
** \details $CPNT$:
**/
/****************************************************************/
#include "$CPNT$.h"

#if defined(HAL_I2C_MODULE_ENABLED)
#if defined(I2C_$CPNT$)
/****************************************************************/
// std libs
//#include <math.h>
//#include <stdlib.h>
/****************************************************************/


$CPNT$_t $CPNT$[I2C_$CPNT$_NB] = { 0 };


/****************************************************************/


__WEAK FctERR NONNULL__ $CPNT$_Init_Sequence($CPNT$_t * const pCpnt)
{
	// get ID & check against values for $CPNT$
	FctERR err = $CPNT$_Get_ChipID(pCpnt, &pCpnt->cfg.ChipID);
	if (err != ERROR_OK)						{ goto ret; }
	if (pCpnt->cfg.ChipID != $CPNT$_CHIP_ID)	{ err = ERROR_COMMON; goto ret; }	// Unknown device

	pCpnt->cfg.$CPNT$_param_1 = 1U;

	ret:
	return err;
}


/****************************************************************/


__WEAK FctERR NONNULL__ $CPNT$_handler($CPNT$_t * const pCpnt)
{
	FctERR err = $CPNT$_Read(pCpnt->cfg.slave_inst, &pCpnt->$CPNT$_val_1, $CPNT$__REG1, 1U);
	if (err != ERROR_OK)	{ goto ret; }

	#if defined(VERBOSE)
		const uint8_t idx = pCpnt - $CPNT$;
		printf("$CPNT$ id%d: FUBARED %d", idx, pCpnt->$CPNT$_val_1);
	#endif

	ret:
	return err;
}


__WEAK FctERR NONNULL__ $CPNT$_handler_it($CPNT$_t * const pCpnt)
{
	FctERR err = ERROR_OK;

	if ($CPNT$_RDY_GPIO_Get(pCpnt))	{ err = $CPNT$_handler(pCpnt); }

	return err;
}


FctERR $CPNT$_handler_all(void)
{
	FctERR err = ERROR_OK;
	
	for ($CPNT$_t * pCpnt = $CPNT$ ; pCpnt < &$CPNT$[I2C_$CPNT$_NB] ; pCpnt++)
	{
		err |= $CPNT$_handler(pCpnt);
	}
	
	return err;
}


FctERR $CPNT$_handler_it_all(void)
{
	FctERR err = ERROR_OK;
	
	for ($CPNT$_t * pCpnt = $CPNT$ ; pCpnt < &$CPNT$[I2C_$CPNT$_NB] ; pCpnt++)
	{
		err |= $CPNT$_handler_it(pCpnt);
	}
	
	return err;
}


/****************************************************************/
#endif
#endif
/****************************************************************/
